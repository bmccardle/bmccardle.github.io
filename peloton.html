<html>
<head>

<script>

var PELOTON_USERNAME = 'Opti_Spin'
var PELOTON_PASSWORD = 'Bremelcassky4'

var base_url = 'https://api.onepeloton.com/'

const data = { 'username_or_email': PELOTON_USERNAME,

'password' : PELOTON_PASSWORD,
'muteHttpExceptions' : true
 };
 
 const url = base_url + 'auth/login';


let request = new Request(url, {
  method: 'POST',
  mode: 'no-cors',
  body: JSON.stringify(data),
  headers: new Headers({
    'Content-Type': 'application/json; charset=UTF-8'
    
  })
});

fetch(request)
  .then((response) => {
  console.log(response.text())
      return response.json();
    })
    .then((data) => {
      let authors = data;

      authors.map(function(author) {
      
      console.log(author.user_id)

      });
    })
    .catch(function (error) {
     console.log(error);
});



async function getUsers() {

var PELOTON_USERNAME = 'Opti_Spin'
var PELOTON_PASSWORD = 'Bremelcassky4'

var base_url = 'https://api.onepeloton.com/'

const data = { 'username_or_email': PELOTON_USERNAME,

'password' : PELOTON_PASSWORD,
'muteHttpExceptions' : true
 };
 
    let url = base_url + 'auth/login';
    try {
        let res = await fetch(url, {
  method: 'POST', // or 'PUT'
  mode: 'no-cors',
  headers: {
    'Content-Type': 'application/json',
    'Access-Control-Allow-Origin':'*'
    
  },
  body: JSON.stringify(data),
})
        console.log(await res.json())
        return await res.json();
    } catch (error) {
        console.log(error);
    }
}

</script>

</head>
<body>

<button onclick="getUsers()">Click</button>


<script>

async function getWO(){

var PELOTON_USERNAME = 'Opti_Spin'
var PELOTON_PASSWORD = 'Bremelcassky4'
var base_url = 'https://api.onepeloton.com' 




let r = new Request(base_url + 'auth/login');


r.method = 'POST'

r.body = JSON.stringify({
  
  

'username_or_email' : PELOTON_USERNAME, 
'password' : PELOTON_PASSWORD,
'muteHttpExceptions' : true
        })



let json = await r.loadJSON(); // 



let workout_url = base_url + 'api/user/' + json.user_id + '/workouts?sort_by=-created&limit=1000'
// joins=peloton.ride&limit=1&page=0&
let req = new Request(workout_url);

req.method = 'GET'


let wo_json  = await req.loadJSON();

console.log(wo_json)

}

</script>
</body>
</html>
